# accdb

It's like passwords.txt but better.

Seriously.

  - I want my password list to be editable anywhere I go.
  - I want to edit it with Vim and Notepad2.
  - I want to use my own field names for everything.
  - But I don't want to be annoyed with strict syntax requirements.
  - I want it to be searchable from command line, conveniently.

So yes, I have a `passwords.txt`.

Of course, it has large downsides such as complete lack of encryption, and all passwords visible in my editor. So far, neither is a large problem to me – I have become fairly paranoid about the storage media it's on, and I usually avoid editing it in public. Who knows, maybe I'll add some scrambling later, or import it to KeePass, but so far this does the job for me.

## Syntax

    (metadata)
    = Title
    ; Comment.
        {entry-uuid}
        field: value
        field: value
        !field: secretvalue
        !field: <base64> c2VjcmV0dmFsdWU=
        + tag, tag, tag

A simpler example:

    = Gmail
        login: grawity@gmail.com
        pass: nottelling
        date.signup: 2009-02-31
        + is:email

`accdb touch` takes care of messed up syntax – adjusts indentation, parses `field=value`, puts certain fields on top, so I don't have to bother with all that when adding new entries. !fields are hidden by `accdb grep` when displaying search results.

When saving the database (e.g. `ad touch`), accdb will dump all entries nicely reformatted. Fields are sorted, indents adjusted, missing UUIDs autogenerated.

This is more convenient for me than YAML or such stuff. I even wrote myself a Vim syntax file, it's in the `dotfiles` repo.

Syntax notes:

  * For convenience, `field=value` is also accepted (but translated to `field: value` when saving).

  * The field `pass` is also hidden for historical reasons, despite having no `!` prefix. Fields `pass.*` aren't hidden.

  * Field values starting with "`<base64> `" will be Base64-decoded when reading.

  * In fields named `date.*`, the values "now" and "today" are expanded to current date.

  * Entries tagged `\deleted` will be discarded when writing.

  * Entry UUIDs are used by `ad merge`.

  * Lines starting with `(` and ending with `)` are ignored when reading. They contain such information as "item 243" or "found 2 search results" that doesn't need to be preserved.

  * A comment line starting with `vim:` is the Vim modeline. It's not used by accdb directly, but will be preserved when saving the database.

  * A comment line starting with `dbflags:` is parsed as a list of flags.

    If the `cache` flag is set, accdb will write a second copy of the database at `~/Private/accounts.cache.txt` when updating the main database. accdb uses this cache when the main database is not found.

    If the `conceal` flag is set, accdb will base64-encode private fields when saving the database. This doesn't really add security, it just helps against people glancing at my screen.

## Usage

Searching for a title prefix:

    ad grep amaz

Searching for a tag:

    ad grep +is:hosting

Searching for tags and attributes, with boolean operators:

    ad grep "AND +is:irc (OR @host=*.net* @uri=*.net*)"

Displaying passwords in a search result:

    ad reveal 64
    # short: ad re 64

Copying a password to clipboard:

    ad copy 64
    # short: ad c 64

Editing a few entries:

    ad rgrep +TODO | vipe | ad merge

Editing the entire database:

    vim $ACCDB

Dumping the entire database:

    ad dump          # default storage format
    ad rgrep         # default editable format
    ad dump json     # as JSON (no import yet)
    ad dump yaml     # as YAML (      〃     )

## Search patterns

  - `foo` – matching title (prefix glob)

  - `~foo` – matching title (regex)

  - `@foo` – attribute `foo` present (glob)

  - `@foo=bar` – attribute `foo` present (exact) and has value matching `bar` (glob)

  - `@foo~bar` – attribute `foo` present (exact) and has value matching `bar` (regex)

  - `#123` – item number

  - `AND x y ...`, `OR x y ...`, `NOT x` – boolean operators

  - `(` and `)` for grouping patterns (Lisp/Logo style)

<!-- vim: set ts=8 sw=8 et: -->
